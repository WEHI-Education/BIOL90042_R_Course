{
  "hash": "16afb341048fcd23c66f8b2cd9752003",
  "result": {
    "engine": "knitr",
    "markdown": "---\nfilters:\n  - naquiz\nformat:\n  html:\n    toc: true\n    toc-location: left\n    toc-title: \"In this session:\"\n---\n\n\n# Session 3: Plotting with ggplot2 {#sec-session03}\n\nIn this session we will learn how to create and customise plots using the `ggplot2` package.\n\n::: {.callout-tip title=\"Learning Objectives\"}\nAt the end of this session, learners should be able to:\n\n1.  Create a ggplot and save it for use outside of R\n2.  Describe some of the common ways we can change the appearance of a plot, such as themes, legends and colours.\n3.  List some of the common geoms available in ggplot2 and what types of data they might be useful for\n4.  Use the `facet_wrap` function to create a series of similar plots\n5.  Understand how to use the `patchwork` package to compose multiple plots together into a single figure\n:::\n\nTo get started, let's load the `tidyverse` package, which includes `ggplot2`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\nAnd read in the `mousezempic_dosage_data` that we have been using in previous sessions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmousezempic_dosage_data <- read_csv(\"data/mousezempic_dosage_data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 344 Columns: 9\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (4): mouse_strain, cage_number, replicate, sex\ndbl (5): weight_lost_g, drug_dose_g, tail_length_mm, initial_weight_g, id_num\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n\n## Building our first plot, layer by layer\n\nAlthough R has a built-in plotting system, `ggplot2` is a more powerful and flexible package for creating plots. The `gg` in `ggplot2` stands for \"Grammar of Graphics\", which is a way thinking about how each component of a plot (e.g. axes or colours) is part of the 'language' of data visualisation that allows you to compose complex plots piece by piece, just like you combine words to form sentences.\n\n### Initialisation\n\nWhen making a ggplot, the first thing you need to do is initialise it with the `ggplot()` function. This function takes two arguments:\n\n-   the **data** that you want to visualise (a dataframe/tibble), and\n-   **mapping**, which describes the scales that will be used to display the data (e.g. which variable should be the x axis, which should be represented by colour, etc.)\n\nThe mapping is specified using the `aes()` function, which stands for 'aesthetics'. It takes named arguments, where the names are the aesthetics you want to use to show your data (e.g. `x`, `y`, `colour`, `shape`, etc.) and the values are the names of the columns in your data that you want to use for those aesthetics.\n\nFor example, to make a plot to explore the relationship between the initial weight of the mice and their tail length, we would write:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm))\n```\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-3-1.png){width=2000}\n:::\n:::\n\n\nIn the plot panel (bottom right hand corner), you should now see a blank plot with the x and y axes labelled with the column names we specified in the `aes()` function. There's no data on it yet, because we haven't told ggplot how to physically represent the data on the x and y scales we have specified.\n\n### Adding data\n\nData is represented in ggplot using **geoms** (short for 'geometric objects'). A geom is a visual representation of the data in the plot, such as points, lines or bars. They are named `geom_*` where `*` is the type of geom you want to use. We will cover some of the most common geoms later in this session.\n\nGeoms are added to plots layers (which are drawn on top of one another, like layers of a cake) using the `+` operator.\n\nFor example, let's add points to the plot that we initialised above using `geom_point()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm)) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-4-1.png){width=2000}\n:::\n:::\n\n\nThis gives us a basic scatterplot of the data, with each point representing the tail length and initial weight of a mouse in our dataset.\n\nNotice how we didn't have to specify the data or mapping again when we added the `geom_point()` layer, because the data and mapping are inherited from the initial `ggplot()` function call. This is a common pattern in ggplot2: you only need to specify the data and mapping once, and it is used by all subsequent layers.\n\n::: {.callout-note title=\"The plus `+` vs the pipe `%>%`\"}\nYou might have noticed that `+` in ggplot works similarly to the pipe operator `%>%` in the `dplyr` package in that you place it at the end of a line of code, but **`+` is only ever used in the context of plotting.**\n\nDon't mix them up! A handy way to remember is that `+` looks a bit like the axes of a plot, so it's what you should use when plotting.\n:::\n\n### Overlaying additional data\n\nOf course, this is a very simple plot. To show more information, we can add additional layers using the `+` operator, or use additional aesthetics.\n\nFor example, let's add a a layer containing a linear trendline using `geom_smooth(method = \"lm\")`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-5-1.png){width=2000}\n:::\n:::\n\n\nHere, we supplied the `method = \"lm\"` argument to `geom_smooth()` to tell it fit a linear model (lm for short) to the data and plot the line of best fit, surrounded by a 95% confidence interval. Most geoms will have additional arguments like this that you can use to customise their appearance. Remember that we can check the documentation for geoms and other functions using `?geom_smooth`.\n\n::: {.callout-note title=\"ggplot and missing values\"}\nYou might have noticed that, along with the plot, R is also printing a warning message that lets us know that some rows of our data contain missing values. ggplot2 will automatically remove these rows from the plot (and warn you that it's happening), but it's always a good idea to check your data for missing values before plotting it, as they can affect the results of your analysis. Recall from last session that we can do this by combining the `is.na()` function with `filter()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# find the rows of our data that contain missing values in the columns we're plotting\nmousezempic_dosage_data %>%\n  filter(is.na(initial_weight_g), is.na(tail_length_mm))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 9\n  mouse_strain cage_number weight_lost_g replicate sex   drug_dose_g\n  <chr>        <chr>               <dbl> <chr>     <chr>       <dbl>\n1 CD-1         1A                     NA rep1      <NA>           NA\n2 Black 6      3E                     NA rep3      <NA>           NA\n# ℹ 3 more variables: tail_length_mm <dbl>, initial_weight_g <dbl>,\n#   id_num <dbl>\n```\n\n\n:::\n:::\n\n\n:::\n\nWe can also add additional aesthetics to the plot beyond just `x` and `y`. For example, let's use the `colour` aesthetic to represent the strain of each mouse. To do this, we add `colour = strain` to the `aes()` function that describes the mapping in the `ggplot()` call:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data,\n  aes(x = initial_weight_g, y = tail_length_mm, colour = mouse_strain)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-7-1.png){width=2000}\n:::\n:::\n\n\nNot only are the points now coloured by the strain of each mouse, but there are now three separate colour-coded trendlines, one for each strain. This is because the aesthetic mapping we supply to the `ggplot()` function when initialising the plot is inherited by **all** subsequent layers/geoms.\n\nNotice as well how adding colour to the plot totally changes the way we perceive the data! Without colour and just plotting a single trendline, it appeared that there was an overall negative association between initial weight and tail length, but we can now see that there is actually a positive association within each strain. This is an example of [Simpson's Paradox](https://en.wikipedia.org/wiki/Simpson%27s_paradox), and shows why it's so important to visualise your data!\n\n### Saving plots as images\n\nOnce you've created a plot you're happy with, you'll probably want to save it to use in a paper or presentation. You can do this programmatically using the `ggsave()` function.\n\nTo use `ggsave()`, you need to specify:\n\n-   the filename you want to save the plot as (e.g. `\"my_plot.png\"`),\n-   the plot object you want to save (by default, this is the last plot you created, but you can specify a plot that's been assigned to a variable),\n-   the file type you want to save the plot as (e.g. `device = \"png\"`), and\n-   the dimensions of the plot (e.g. `width = 6, height = 4`). Dimensions are in inches by default, but you can specify them in other units if you prefer by using the units argument (e.g. `units = \"cm\"`)\n\nFor example, to save the last plot we created as a .png file with dimensions of 5 by 7 inches, we would write:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"coloured_scatterplot.png\", device = \"png\", width = 5, height = 7)\n```\n:::\n\n\nOr to save it as a .pdf file with dimensions of 20 by 30 cm:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggsave(\"coloured_scatterplot.pdf\", device = \"pdf\", width = 20, height = 30, units = \"cm\")\n```\n:::\n\n\nGenerally, it's good practice to assign the plot you want to save to a variable, and provide that variable to the 'plot' argument of `ggsave()`, rather than relying on the last plot you created. This makes it more clear what plot you're saving, so that your code is more readable and reproducible.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# first assign the plot to a variable\ncolourful_scatterplot <- ggplot(data = mousezempic_dosage_data,\n  aes(x = initial_weight_g, y = tail_length_mm, colour = mouse_strain)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n\n# then save the plot: notice the 'plot' argument\nggsave(\"coloured_scatterplot.pdf\", plot = colourful_scatterplot, device = \"pdf\", width = 20, height = 30, units = \"cm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n:::\n\n\nIt's also possible to save plots using the export button in the plot panel: ![You can use the export button to save plots interactively](images/S03F01_export.png)\n\nYou can choose to save the plot either as an image: ![Saving an R plot as an image](images/S03F02_export_image.png)\n\nIn this case, you can set the file type and dimensions, and see a preview of the plot before saving it. Tip: it's also possible to change the dimensions of the plot by dragging the bottom left of the preview window.\n\nYou can also save plots as a PDF: ![Saving an R plot as a PDF](images/S03F03_export_pdf.png)\n\nAlthough there is no preview for PDFs within RStudio itself, you can click the 'preview' button to open the PDF in your default PDF viewer.\n\nIn general, it's preferable to save plots programmatically using `ggsave()` because it's more reproducible (because if you ever change your plotting code or data, new plot files can be automatically generated), but the export button can be useful for quickly saving plots during exploratory data analysis (or use the ultimate lazy hack: just screenshot the plot panel!).\n\n::: {.callout-important title=\"Practice exercises\"} Try these practice questions to test your understanding\n\n::: question\n1\\. Which of the following statements about the mapping in a ggplot is **incorrect**?\n\n::: choices\n::: choice\nMapping is specified using the `aes()` function\n:::\n\n::: {.choice .correct-choice}\nMapping refers to the type of plot you want to create (e.g. scatterplot, line plot)\n:::\n\n::: choice\nWhen you specify the mapping in the `ggplot()` function, it is inherited by all subsequent layers/geoms\n:::\n\n::: choice\nMapping allows you to specify which scales (e.g. x, y, colour) should be used to display the data\n:::\n:::\n:::\n\n::: question\n2\\. Which of the following lines of code is a valid way to create a scatterplot of the drug dosage (x) and weight loss (y) in the `mousezempic_dosage_data` dataset?\n\n::: choices\n::: choice\n`ggplot(data = mousezempic_dosage_data, aes(x = drug_dosage, y = weight_loss)) %>% geom_point()`\n:::\n\n::: choice\n`ggplot(data = mousezempic_dosage_data, x = drug_dosage, y = weight_loss) + geom_point()`\n:::\n\n::: choice\n`ggplot2(data = mousezempic_dosage_data, aes(x = drug_dosage, y = weight_loss))`\n:::\n\n::: {.choice .correct-choice}\n`ggplot(data = mousezempic_dosage_data, aes(x = drug_dosage, y = weight_loss)) + geom_point()`\n:::\n:::\n:::\n\n::: question\n\n3. How could you programmatically save the plot created in question 2 as a .pdf file with dimensions of 10 by 15 cm?\n\n::: choices\n::: {.choice .correct-choice}\n`ggsave(\"drug_dosage_vs_weight_loss.pdf\", device = \"pdf\", width = 10, height = 15, units = \"cm\")`\n:::\n\n::: choice\n`save(\"drug_dosage_vs_weight_loss.pdf\", device = \"pdf\", width = 10, height = 15, units = \"cm\")`\n:::\n\n::: choice\n`ggsave(\"drug_dosage_vs_weight_loss.pdf\", device = \"pdf\", width = 10, height = 15)`\n:::\n\n::: choice\n`ggsave(\"drug_dosage_vs_weight_loss.pdf\", width = 10, height = 15)`\n:::\n\n<details>\n\n<summary>Solutions</summary>\n\n1.  Mapping in ggplot refers to the scales that will be used to display the data (e.g. x, y, colour), not the type of plot you want to create. It is specified using the `aes()` function, and when specified in the initial `ggplot()` function call, is inherited by all subsequent layers/geoms.\n2.  The correct way to create a scatterplot of the drug dosage and weight loss in the `mousezempic_dosage_data` dataset is `ggplot(data = mousezempic_dosage_data, aes(x = drug_dosage, y = weight_loss)) + geom_point()`. This specifies the data and mapping in the `ggplot()` function call, and adds a layer of points to the plot using `geom_point()`. The `%>%` operator is not used in ggplot2, and the `x` and `y` mapping should be specified within the `aes()` function. Also, remember that although ggplot2 is the name of the package, the function you use to initialise a plot is `ggplot()`.\n3.  To programmatically save the plot created in question 2 as a .pdf file with dimensions of 10 by 15 cm, you would use the `ggsave()` function with the arguments `ggsave(\"drug_dosage_vs_weight_loss.pdf\", device = \"pdf\", width = 10, height = 15, units = \"cm\")`. This specifies the filename, file type, dimensions, and units of the plot you want to save. Remember that by default, dimensions are in inches (boooo), so you need to specify the units as \"cm\" to save the plot with dimensions in centimetres.\n\n</details>\n\n:::\n\n## Some commonly used geoms\n\nggplot2 has (as of writing) almost 50 different geoms that you can use to represent your data. You can see the full list in the [ggplot2 documentation](https://ggplot2.tidyverse.org/reference/#geoms), but some of the most commonly used geoms include:\n\n-   `geom_point()`\n-   `geom_line()`\n-   `geom_boxplot()`\n-   `geom_col()`\n-   `geom_violin()`\n-   `geom_h/vline()`\n\nIn this section, we will briefly cover these geoms and how you might use them to visualise your data. It's not designed to be an exhaustive list, but hopefully it will help you get started with some of the most common types of plots you might want to create.\n\n::: {.callout-note title=\"How do I make a ... plot in ggplot2?\"}\nOften, you might come across a specific type of plot you want to make that is a bit more complex than the basic geoms we've covered here. If you know the name of the plot you're wanting to make, you can often find a tutorial/guide online by googling, or you could ask an AI assistant like ChatGPT. Particularly for specific types of data (e.g. clinical data, phylogenetic data), there are often field-specific packages that provide geoms or functions to make particular types of plots, like the [ggtree package](https://yulab-smu.top/treedata-book/index.html) for phylogenetic trees or the [survminer package](https://rpkgs.datanovia.com/survminer/) for survival plots.\n\nIf the plot doesn't have a specifc name, you can try to break it down by thinking about the geoms you might need to use to represent the data, or try uploading a picture of a similar plot to ChatGPT.\n\nWhatever method you use, remember to add 'ggplot2' to your search query to get the most relevant results, as there are many different plotting packages in R!\n:::\n\n### geom_point\n\nAbove, we saw how to use `geom_point()` to create a scatterplot, but `geom_point()` can be used in other ways too. For example, you can use it to create a dot plot, where the x axis is categorical and the y axis is continuous:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make a dot plot of initial weight by mouse strain\nggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = initial_weight_g)) +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-11-1.png){width=2000}\n:::\n:::\n\n\nNotice how the points are stacked on top of one another for each strain. This is because the x axis is categorical, and ggplot2 doesn't know how to spread the points out. This can make it difficult to see the individual points, so when making a plot like this it's often useful to add the  `position = position_jitter()` argument to `geom_point()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# make a jittered dot plot of initial weight by mouse strain\nggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = initial_weight_g)) +\n  geom_point(position = position_jitter())\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-12-1.png){width=2000}\n:::\n:::\n\nThe `position_jitter()` function adds a small amount of random noise to the x axis position of each point, which helps to spread them out and make it easier to see the individual points. Like most functions in ggplot2, `position_jitter()` will try to guess an appropriate amount of jitter to add, but you can specify the amount as well:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use less jitter so there is more distinction between the different mouse strains\nggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = initial_weight_g)) +\n  geom_point(position = position_jitter(width = 0.2))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-13-1.png){width=2000}\n:::\n:::\n\nThe exact amount of jitter you need will depend heavily on your data, so it's often a good idea to experiment with different amounts to see what works best.\n\n::: {.callout-note title=\"Beeswarm plots\"}\nAnother way to spread out points in a dot plot is to use a beeswarm plot, in which points are spread out slightly along the x axis so that they don't overlap. The `ggbeeswarm` package provides a `geom_beeswarm()` function that you can use to create beeswarm plots in ggplot2 (rather than using `geom_point(position = position_jitter())` like we did here). For more information, see the [ggbeeswarm documentation](https://github.com/eclarke/ggbeeswarm/blob/main/README.md).\n:::\n\n### geom_line\nAs the name suggests, `geom_line()` is used to create line plots. These are useful for showing trends over time or across a continuous variable. Since we don't have a time variable in our dataset, let's use the `drug_dosage` variable to show how weight loss changes with increasing dosage:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +\n  geom_line()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_line()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-14-1.png){width=2000}\n:::\n:::\n\n(In reality the relationship between these variables is probably better represented as points on a scatterplot rather than as a line, but this is just an example of how you can use `geom_line()`).\n\nIt's also possible to combine `geom_line()` with `geom_point()` to show the individual data points as well as the connection between them:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +\n  geom_line() +\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_line()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-15-1.png){width=2000}\n:::\n:::\n\n\n### geom_hline / geom_vline\nThe `geom_hline()` and `geom_vline()` functions are used to add horizontal and vertical lines to a plot, respectively. Although simple, they are often useful for highlighting specific values or thresholds in your data. To use them, you need to specify the `yintercept` (for `geom_hline()`) or `xintercept` (for `geom_vline()`) argument, which specifies where to draw the line.\n\nFor example, let's add a horizontal line to our scatterplot of drug dosage and weight loss at the 4g mark, which might represent a clinically significant amount of weight loss:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +\n  geom_point() +\n  geom_hline(yintercept = 4)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-16-1.png){width=2000}\n:::\n:::\n\n\nWe could also add a vertical line at the 0.0025g mark to show the theorectical maximum dosage of the drug:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +\n  geom_point() +\n  geom_hline(yintercept = 4) +\n  geom_vline(xintercept = 0.0025)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-17-1.png){width=2000}\n:::\n:::\n\nNotice how adding this line extends the x axis to include 0.0025, even though there are no data points at that value. This is because, by default, ggplot2 chooses axes limits for you that include all the data and any additional layers you add to the plot.\n\n### geom_boxplot\nBoxplots are a useful way to visualise the distribution of a continuous variable across different categories, allowing you to easily see the median, quartiles, and any outliers in the data. To create a boxplot in ggplot2, you can use the `geom_boxplot()` function.\n\nFor example, let's create a boxplot of the initial weight of the mice by strain:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = initial_weight_g)) +\n  geom_boxplot()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-18-1.png){width=2000}\n:::\n:::\n\n\nIt's often useful to add points to a boxplot to show the individual data points as well as the summary statistics. You can do this by adding a `geom_point()` layer to the plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = initial_weight_g)) +\n  geom_boxplot() +\n  geom_point(position = position_jitter(width = 0.2))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](session_3_files/figure-html/unnamed-chunk-19-1.png){width=2000}\n:::\n:::\n\n\n\n\n\n### geom_violin\n\n### geom_col\nincluding position dodge and stack\n\n\n## Working with scales\n\nlog transformation, changing colour palette\n\n## Making a plot pretty\nNow that we've covered the basics of creating plots in ggplot2, let's talk about how to make them look good (because so far, the ones we've made have been a little plain looking!)\n\nThere are countless ways to customise the appearance of a plot in ggplot2, and we'll cover some of the most common ones here.\n\n### Labels and text\n\nadding title, axis labels\n\nchanging size etc to be readable\n\nhow to remove scientific notation on axes\n\n### Themes\n\nintroduce concept of themes\n\nhow to modify parts of themes\n\n### Changing colours/sizes/shapes\n\nexactly what it sounds like\n\nmention about\n\n### Legends\n\nchanging position, removing it\n\n## Making many similar plots with facets\n\nhow to facet with facet_wrap() and scales = \"free\" or not\n\n## Laying out multiple plots into a single figure\n\ncombining plots with patchwork\n\n## Summary\n\n::: {.callout-note title=\"Useful packages that extend ggplot2\"}\nThere are many packages that extend the functionality of ggplot2, such as:\n\nthere are also a wealth of extensions to ggplot2 that provide additional geoms or functionality for specific types of data or plots, such as...\n:::\n\n### Practice questions",
    "supporting": [
      "session_3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}